---
import AuthLayout from "@/layouts/AuthLayout.astro";
import { PasswordResetForm } from "@/components/auth/PasswordResetForm";

// This page is public - no session check needed
// Handles both requesting password reset and setting new password (when token is present)
const token = Astro.url.searchParams.get("token");
const type = Astro.url.searchParams.get("type");

// When token and type=recovery are present, user clicked email link to reset password
const isResettingPassword = token && type === "recovery";
---

<AuthLayout title={isResettingPassword ? "Set New Password" : "Reset Password"} - Initiative Forge>
  <PasswordResetForm client:load isResettingPassword={isResettingPassword} token={token} />

  <p class="mt-6 text-center text-sm text-slate-400">
    Remember your password?{" "}
    <a
      href="/auth/login"
      class="font-semibold text-blue-400 hover:text-blue-300 transition-colors"
    >
      Sign in here
    </a>
  </p>
</AuthLayout>
